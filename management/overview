# RealMotionEngine (RME) â€” Architecture Overview

> **Scope**Â â€” This overview\.md is the singleâ€‘sheet entryâ€‘point for all architecture documentation of **RealMotionEngine**. It explains the projectâ€™s purpose, highâ€‘level design, layer responsibilities, and links to detailed specs stored alongside this file.

---

## 1Â Â Project Purpose & Vision

RealMotionEngine (RME) is a **browserâ€‘first realâ€‘time motionâ€‘tracking and research platform**. It enables lowâ€‘latency capture of human motion via any webcam, advanced filtering/learning pipelines, and highâ€‘fidelity 3D visualisationâ€”all inside a modern web stack.

*Key objectives*

| # | Objective                                                                               |
| - | --------------------------------------------------------------------------------------- |
| 1 | **Subâ€‘100â€¯ms endâ€‘toâ€‘end latency** using C++Â â†’Â WASM filters on a dedicated Worker thread |
| 2 | **Researchâ€‘ready**Â â€” reproducible experiments, metrics, versioning (DVCÂ /Â MLflow)       |
| 3 | **Plugin architecture** for filters, ML models, and render engines                      |
| 4 | **Crossâ€‘engine 3D**Â â€” UnityÂ WebGL primary, Three.js fallback                            |

---

## 2Â Â Highâ€‘Level Architecture

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â‘ Â Frontâ€‘EndÂ Layer          â”‚ ReactÂ +Â Next.js UI              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ raw frames
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â‘¡Â MediaPipeÂ Component      â”‚ 2D/3D landmarks                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ landmarks
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â‘¢Â FilterÂ LayerÂ (Worker)    â”‚ WASM plugins (Kalman, LPFâ€¦)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ smoothed data
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â‘£Â Motionâ€‘LearningÂ Layer    â”‚ SupervisedÂ /Â RL pipeline       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ predictions / models
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â‘¤Â VisualisationÂ Layer      â”‚ UnityÂ WebGLÂ /Â Three.js         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ canvas stream
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â‘¥Â RecorderÂ &Â Logger        â”‚ MediaRecorderÂ +Â CSV/Parquet    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ logs / video
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â‘¦Â ResearchÂ Support         â”‚ configsÂ Â· notebooksÂ Â· metrics  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3Â Â Layer Responsibilities

| # | Layer               | Core Tech             | Responsibilities                            |
| - | ------------------- | --------------------- | ------------------------------------------- |
| â‘  | **Frontâ€‘End/UI**    | ReactÂ Â·Â Next.js       | camera permissions, settings UI, state mgmt |
| â‘¡ | **MediaPipe**       | `@mediapipe/pose`     | landmark extraction                         |
| â‘¢ | **Filter**          | WorkerÂ +Â WASM         | latencyâ€‘optimised smoothing, plugin mgr     |
| â‘£ | **Motionâ€‘Learning** | PythonÂ (TF/PyTorch)   | offline/online training, ONNX serving       |
| â‘¤ | **Visualisation**   | UnityÂ WebGL           | 3D skeletonÂ +Â mesh, accuracy heatmap        |
| â‘¥ | **Recorder/Logger** | MediaRecorder         | multiâ€‘channel capture, file export          |
| â‘¦ | **Research**        | YAMLÂ configs, Jupyter | experiment orchestration, metrics           |

---

## 4Â Â Differentiators

*WASM acceleration*, *pluginised filters*, *research pipeline outâ€‘ofâ€‘box*, *Unityâ€‘quality visuals*, and *browserâ€‘only install* make RME unique compared with typical JSâ€‘based mocap demos.

---

## 5Â Â Document Map (detailed specs)

| Area                | File                               |
| ------------------- | ---------------------------------- |
| API surface         | `API_Architecture.md`              |
| Build / CI          | `Build_Architecture.md`            |
| Deployment          | `Deployment_Architecture.md`       |
| Directory layout    | `Directory_Architecture.md`        |
| DataÂ /Â Control flow | `Flow_Architecture.md`             |
| Module boundaries   | `Module_Architecture.md`           |
| Security model      | `Security_Architecture.md`         |
| State management    | `State_Management_Architecture.md` |
| Testing strategy    | `Testing_Architecture.md`          |
| WASM integration    | `WASM_Integration_Architecture.md` |
| Best practices      | `BestPractices_Architecture.md`   |
| Release process     | `Release_Architecture.md`         |

---

## 6Â Â Quickâ€‘Start Commands

```bash
# install deps
npm install

# run dev server
npm run dev

# build Unity WebGL (inside ./unity)
# 1. open Unity â†’ WebGL build target â†’ Build & Run
```
## 7  Operational Conventions ğŸ›  *(new section)*
| Topic                  | Rule (see `.cursorrules` for the machine-readable spec) |
| ---------------------- | ------------------------------------------------------- |
| **Lint / Format**      | Pre-commit hook must run `npm run lint` & `npm run format:check` |
| **Testing**            | Vitest / Jest â€” _minimum_ 70 % coverage enforced in CI |
| **CI Workflow**        | `lint â†’ test â†’ build`; Unity WebGL build only on version tags |
| **Performance budgets**| WebGL â‰¥ 60 FPS; WASM â‰¤ 1 ms per call |
| **Accessibility**      | Lighthouse A11y score â‰¥ 90 |
| **Security**           | Zod validation on all external inputs; strict CSP headers |
| **Issue / PR templates** | Templates in `.github/` must link related architecture MD |
| **Versioning**         | Semantic Versioning; breaking changes tagged with `feat!` / `fix!` |
---

## 8  Revision History â€” **update**
| Date       | Version | Notes                                      |
| ---------- | ------- | ------------------------------------------ |
| 2025-05-08 | v1.1    | Added **Operational Conventions** section |

*Last updatedÂ :Â 2025â€‘05â€‘08*
